* [返回主页](../../README.md)

## 代码整洁之道
### 简化条件表达式
#### 分解条件式
```markdown
有一个复杂的条件（if-then-else）语句，从if、then、else 三个段落中分别提炼出独立函数
```
```java
//原代码
private ExtensionResult<Boolean> push(ExtensionParameter parameter, int needModel) {
    log.info("push parameter:{}，needModel:{}" + JSONObject.toJSONString(parameter), needModel);
    if (parameter == null || parameter.getParameters() == null
            || parameter.getParameters().length == 0 || parameter.getParameters().length <= 1) {
        log.info("parameter is null");
        return ExtensionResult.success(true);
    }
    ..................
    return ExtensionResult.success(true);
}
```
```java
//改造后：
private ExtensionResult<Boolean> push(ExtensionParameter parameter, int needModel) {
    log.info("push parameter:{}，needModel:{}" + JSONObject.toJSONString(parameter), needModel);
    if (isParameterInvalid(parameter)) {
    log.info("parameter is null");
    return ExtensionResult.success(true);
    }
    ..................
    return ExtensionResult.success(true);
    }

private boolean isParameterInvalid(final ExtensionParameter parameter) {
    return parameter == null || parameter.getParameters() == null
    || parameter.getParameters().length == 0 || parameter.getParameters().length <= 1;
}
```

#### 合并条件式
```markdown
有一系列条件测试，都得到相同结果。将这些测试合并为一个条件式，并将这个条件式提炼成为一个独立函数
```
```java
//原代码
public List<JSONObject> getSubDeviceRoomRelationList(ApiRequestDO apiRequestDO) {
    String gwId = apiRequestDO.getGwId();
    ValidateUtils.validateBlankParam("gwId", gwId, true);
    GatewayCache gateway = deviceAdaptService.getByIdInCache(gwId);
    if (null == gateway) {
        logger.warn("gateway is not exist! {}", gwId);
        throw new TermNotExistsException(EuropaTermCode.DEVICE);
    }
    if (StringUtils.isBlank(gateway.getOwnerId())) {
        logger.warn("gateway ownerId is empty! {}", gwId);
        throw new TermNotExistsException(EuropaTermCode.DEVICE);
    }
    ...........
    return result;
}
```
```java
//改造后：
public List<JSONObject> getSubDeviceRoomRelationList(ApiRequestDO apiRequestDO) {
    String gwId = apiRequestDO.getGwId();
    ValidateUtils.validateBlankParam("gwId", gwId, true);
    GatewayCache gateway = deviceAdaptService.getByIdInCache(gwId);
    if (isTermNotExists(gateway)) {
        throw new TermNotExistsException(EuropaTermCode.DEVICE);
    }
    ...........
    return result;
}

private boolean isTermNotExists(final GatewayCache gateway) {
    return null == gateway || StringUtils.isBlank(gateway.getOwnerId());
}
```

#### 合并重复的条件片段
```markdown
在条件式的每个分支上有着相同的一段代码,将这段重复代码搬移到条件式之外。
```
```java
//原代码
if (isSpecialDeal()) {
    total = price * 0.95;
    send();
}else {
    total = price * 0.98;
    send();
}
```
```java
//改造后：
if (isSpecialDeal())
    total = price * 0.95;
else
    total = price * 0.98;
send();
```

#### 以break 语句或return 的语句取代控制标记



